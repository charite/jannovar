package de.charite.compbio.jannovar.vardbs.clinvar;

import de.charite.compbio.jannovar.vardbs.base.DBAnnotationOptions;
import htsjdk.variant.vcf.VCFHeader;
import org.junit.Assert;
import org.junit.Test;

public class ClinVarVCFHeaderExtenderTest {

  @Test
  public void test() {
    VCFHeader header = new VCFHeader();

    // Check header before extension
    Assert.assertEquals(0, header.getFilterLines().size());
    Assert.assertEquals(0, header.getInfoHeaderLines().size());
    Assert.assertEquals(0, header.getFormatHeaderLines().size());
    Assert.assertEquals(0, header.getIDHeaderLines().size());
    Assert.assertEquals(0, header.getOtherHeaderLines().size());

    DBAnnotationOptions options = DBAnnotationOptions.createDefaults();
    options.setReportOverlapping(true);
    options.setReportOverlappingAsMatching(false);
    options.setIdentifierPrefix("CLINVAR_");

    new ClinVarVCFHeaderExtender(options).addHeaders(header);

    // Check header after extension
    Assert.assertEquals(0, header.getFilterLines().size());
    Assert.assertEquals(6, header.getInfoHeaderLines().size());
    Assert.assertEquals(0, header.getFormatHeaderLines().size());
    Assert.assertEquals(6, header.getIDHeaderLines().size());
    Assert.assertEquals(0, header.getOtherHeaderLines().size());

    Assert.assertNotNull(header.getInfoHeaderLine("CLINVAR_BASIC_INFO"));
    Assert.assertNotNull(header.getInfoHeaderLine("CLINVAR_VAR_INFO"));
    Assert.assertNotNull(header.getInfoHeaderLine("CLINVAR_DISEASE_INFO"));
  }
}
